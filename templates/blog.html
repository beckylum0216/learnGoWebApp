<!DOCTYPE html>
<html>
<link rel="stylesheet" href="/static/css/foundation.css">
<link rel="stylesheet" href="/static/css/app.css">
<head>
	<title>Blog Markdown</title>
</head>

<body>
	<div class="row ">
		{{if .Session.Unauthenticated}}
		<form action="/register" method="POST">
			<div><input type="text" name="user_name" placeholder="User name"/></div>
			<div><input type="email" name="user_email" placeholder="Your email" /></div>
			<div><input type="password" name="user_password" placeholder="Password" /></div>
			<div><input type="password" name="user_password2" placeholder="Password (repeat)" /></div>
			<div><input type="submit" value="Register" /></div>
		</form>
		{{end}}

		<div class="medium-12 columns alignLeft">

			<h1>{{.Title}}</h1>
			<p>
				{{.Content}}
			</p>
			<div class="alignLeft">{{.Date}}</div>
		</div>


		{{range .Comments}}

		<div class="medium-12 columns">
			<h3>Comment by {{.Name}} ({{.Email}})</h3>
			<p>{{.CommentText}}</p>
		
		</div>

		<div class="medium-12 columns">
			<h2>Edit</h2>
			<form onsubmit="return putComment(this);">
			<!--<form action="/api/commentz/" method="PUT">-->
				<input type="text" name="id" class="edit_id" value="{{.Id}}" />
				<input type="text" name="name" class="edit_name" placeholder="Your Name" value="{{.Name}}" />
				<input type="text" name="email" class="edit_email" placeholder="Your Email" value="{{.Email}}" />
				<textarea class="text" name="comments" class="edit_comments">{{.CommentText}}</textarea>
				<input class="button" type="submit" value="Edit" />
			</form>
		</div>
		{{end}}


		
		<form action="/api/comments" method="POST">
			<div class="medium-12 columns ">
				<div class="text">
					<input type="hidden" name="guid" value="{{.GUID}}" />
				</div>
				<div class="text">
					<input type="text" name="name" placeholder="Your Name" />
				</div>
				<div class="text">
					<input type="email" name="email" placeholder="Your Email" />
				</div>
				<div class="textarea">
					<textarea name="comments" placeholder="Your Comments"></textarea>
				</div>
				<div>
					<input type="submit" class="button" value="Add Comments" />
				</div>
			</div>
		</form>
		
	</div>
		

</body>


<script>
	function putComment(el) {
		var id = $(el).find('.edit_id').val();
		var name = $(el).find('.edit_name').val();
		var email = $(el).find('.edit_email').val();
		var text = $(el).find('.edit_comments').val();
		$.ajax({
			url: '/api/commentz/'+id,
			type: 'PUT',
			success: function(res) {
				alert('Comment Updated!');
			}
		});
		return false;
	}
</script>

</html>

